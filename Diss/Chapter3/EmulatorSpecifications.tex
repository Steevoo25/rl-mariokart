% !TEX root =  ../Dissertation.tex

\chapter{Emulator Specification}
\section{motivations}
\cite{DolphinEmulator}
previous experience\\ 
most widely used\\
api access\cite{DolphinWithScriptingSupport}\\
savestates for resetting\\
dumping pixel data - mp4, configure to frame by frame. configurabel jpg level, dumps current frame\\
allows multiple concurrent controllers - possible to play against agent\\
playing the game - iso file from genuine wii and disc\\
cheat codes readily available - displays relevant information

\section{Memory access}
\subsection{Process}
iterative search process using Dolphin Memory Engine + Cheat code to find required memory addresses \cite{DolphinMemoryEngine}
\\Gecko code showed value to search for
\\ iteratively search through memory until address was found 
\\ use api to read addresses during execution
\begin{figure}
    \centering
    \includegraphics{Preamble/BirmCrest.png}
    \caption{Screenshot of Dolphin Memory Engine}
    \label{fig:dme}
\end{figure}
\section{Descriptions}
what these values mean in terms of the game
\begin{itemize}
    \item Speed - current speed of vehicle
    \item Race Completion \% - current completion of entire race 1-2 = lap 1, 2-3 = lap 2, 3-4 = lap 3, 4 = finished
    \item Miniturbo charge - 0-270
    \item Wheelie = 0,1
    \item Road Type = Normal road = 0, Offroad = 3, other types of road exist but not on this track
\end{itemize}
\begin{table}[h]
    \centering
    \begin{tabular}{l|c|c|c}
    \textbf{Name}  & \textbf{Location} & \textbf{Type (in Memory)} & \textbf{Range}\\
    \hline
     Speed  &        \texttt{0x80E4C678} & 32-bit Float  & $$[0, 113.4]$$\\
     Completion  &   \texttt{0x80E43708} & 32-bit Float  & $$[0, 4] $$\\
     MT Charge &     \texttt{0x80E4C756} & 16-bit Integer& $$\{0,270\}$$\\
     Wheelie State & \texttt{0x90284F04} & 16-bit Integer& $$\{0,1\}$$\\
     Road Type &     \texttt{0x80E51CE8} & 16-bit Integer& $$ \{0,7\} $$\\
    \end{tabular}
    \caption{Memory Addresses in Mario Kart Wii's emulated memory}
    \label{tab:memory-addresses}
\end{table}
\section{Controller}
using emulated gamecube controller - most precise out of controllers available \\
normal wiimotes use motion control - lots of possible states\\
Inputs available
\begin{itemize}
    \item 'A' Button - accelerates kart up to top speed when held
    \item 'B' Button - performs 2 actions - brake when held with no steering direction, drift when held with a steering direction
    \item 'Up' Button - located on d-pad, performs a wheelie, increasing top speed but greatly decreasing turning angle and speed
    \item Main Control Stick - steers kart, 7 states hard/soft left/right and neutral - only horizontal movement
\end{itemize}
\begin{figure}
    \centering
    \includegraphics[width=0.8\textwidth]{Figures/controllerinputs.png}
    \caption{Diagram of GameCube controller with available inputs labelled}
    \label{fig:laballed-gc-diagram}
\end{figure}
\section{Drawbacks}
3rd party software - many issues undocumented, requires specific configurations/workarounds
\\ savestate issue
\\importing python packages - not all supported
\\overrall best option